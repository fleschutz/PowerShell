Script: *write-value.ps1*
========================

This PowerShell script writes the given value with the unit and the value range to the console.

Parameters
----------
```powershell
PS> ./write-value.ps1 [[-value] <Single>] [[-unit] <String>] [[-redMin] <Single>] [[-yellowMin] <Single>] [[-yellowMax] <Single>] [[-redMax] <Single>] [<CommonParameters>]

-value <Single>
    Specifies the value
    
    Required?                    false
    Position?                    1
    Default value                0.5
    Accept pipeline input?       false
    Aliases                      
    Accept wildcard characters?  false

-unit <String>
    
    Required?                    false
    Position?                    2
    Default value                Mach
    Accept pipeline input?       false
    Aliases                      
    Accept wildcard characters?  false

-redMin <Single>
    
    Required?                    false
    Position?                    3
    Default value                0
    Accept pipeline input?       false
    Aliases                      
    Accept wildcard characters?  false

-yellowMin <Single>
    
    Required?                    false
    Position?                    4
    Default value                0
    Accept pipeline input?       false
    Aliases                      
    Accept wildcard characters?  false

-yellowMax <Single>
    
    Required?                    false
    Position?                    5
    Default value                0
    Accept pipeline input?       false
    Aliases                      
    Accept wildcard characters?  false

-redMax <Single>
    
    Required?                    false
    Position?                    6
    Default value                0
    Accept pipeline input?       false
    Aliases                      
    Accept wildcard characters?  false

[<CommonParameters>]
    This script supports the common parameters: Verbose, Debug, ErrorAction, ErrorVariable, WarningAction, 
    WarningVariable, OutBuffer, PipelineVariable, and OutVariable.
```

Example
-------
```powershell
PS> ./write-value.ps1 95.0 "°C" 0 10 90 100
[0--------95°C-100]

```

Notes
-----
Author: Markus Fleschutz | License: CC0

Related Links
-------------
https://github.com/fleschutz/PowerShell

Script Content
--------------
```powershell
<#
.SYNOPSIS
	Writes a value with unit and range
.DESCRIPTION
	This PowerShell script writes the given value with the unit and the value range to the console.
.PARAMETER value
	Specifies the value
.EXAMPLE
	PS> ./write-value.ps1 95.0 "°C" 0 10 90 100
	[0--------95°C-100]
.LINK
	https://github.com/fleschutz/PowerShell
.NOTES
	Author: Markus Fleschutz | License: CC0
#>

param([float]$value = 0.5, [string]$unit = "Mach", [float]$redMin, [float]$yellowMin, [float]$yellowMax, [float]$redMax)

function WriteValueInRange([float]$value, [string]$unit, [float]$redMin, [float]$yellowMin, [float]$yellowMax, [float]$redMax) {
	$line = "--------------------------------------"
	$text = "[$redMin$value$unit$redMax]"
	[float]$both = 20.0 - $text.Length
	if ($value -gt $redMax) {
		Write-Host "[$redMin$($line.Substring(0,$both))$redMax]" -noNewline
		Write-Host "$value$unit" -noNewline -foregroundColor red
	} elseif ($value -lt $redMin) {
		Write-Host "$value$unit" -noNewline -foregroundColor red
		Write-Host "[$redMin$($line.Substring(0,$both))$redMax] " -noNewline
	} else {
		[float]$left = (($value - $redMin) * $both) / ($redMax - $redMin)
		if ($left -lt 1.0) { $left = 1.0 }
		elseif ($left -gt ($both - 1.0)) { $left = $both - 1.0 }
		[float]$right = $both - $left
		Write-Host "[$redMin$($line.Substring(0,$left))" -noNewline
		if (($value -le $yellowMin) -or ($value -ge $yellowMax)) {
			Write-Host "$value$unit" -noNewline -foregroundColor yellow
		} else {
			Write-Host "$value$unit" -noNewline -foregroundColor green
		}
		Write-Host "$($line.Substring(0,$right))$redMax]" -noNewline
	}
}

Write-Host ""
Write-Host "   TRACK " -noNewline
WriteValueInRange 50.0 "°" 0 0 360 360
Write-Host ""

Write-Host "   ALT   " -noNewline
WriteValueInRange 800 "m" 0 0 6000 8000
Write-Host ""

Write-Host "   SPEED " -noNewline
WriteValueInRange 230 "km/h" 0 0 180 200
Write-Host ""

Write-Host "   BANK  " -noNewline
WriteValueInRange -30.3 "°" -30 -10 10 30
Write-Host ""

Write-Host "   ENG   " -noNewline
WriteValueInRange 2000 "RPM" 0 0 5000 6000
Write-Host ""

Write-Host "   TEMP  " -noNewline
WriteValueInRange 21.8 "°C" 0 10 90 100
Write-Host ""

Write-Host "   FUEL  " -noNewline
WriteValueInRange 0.1 "l" 0 5 60 65
Write-Host ""

Write-Host "   FREQ  " -noNewline
WriteValueInRange 104.4 "MHz" 80 80 108 108
Write-Host ""

Write-Host "   BRAKE " -noNewline
WriteValueInRange 0.0 "%" 0 -1 90 100
Write-Host ""

exit 0 # success
```

*(page generated by convert-ps2md.ps1 as of 08/25/2025 16:51:30)*
